---
title: Docker安装常用软件步骤
tags: Linux Docker
---

## 一、MySQL

　　1、下载镜像

```shell
docker pull mysql:5.7
```

　　2、启动服务

```shell
docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql \
-e MYSQL_ROOT_PASSWORD=123456  \
--restart=always \
-d mysql:5.7
```

　　3、如果服务器拒绝访问，可能需要开启防火墙端口

```shell
firewall-cmd --zone=public --add-port=3306/tcp --permanent
firewall-cmd --reload
```

## 二、Redis

　　1、下载镜像

```shell
docker pull redis:7
```

　　2、启动服务

```shell
docker run -p 6379:6379 --name redis \
-v /mydata/redis/data:/data \
--restart=always \
-d redis:7 redis-server
```

　　3、连接Redis客户端

```shell
docker exec -it redis redis-cli
```

## 三、Elasticsearch

* ### 安装Elasticsearch

　　1、下载镜像

```shell
docker pull elasticsearch:7.17.3
```

　　2、修改虚拟内存区域大小，否则会因为过小而无法启动

```shell
sysctl -w vm.max_map_count=262144
```

　　3、启动服务

```shell
docker run -p 9200:9200 -p 9300:9300 --name elasticsearch \
-e "discovery.type=single-node" \
-e "cluster.name=elasticsearch" \
-e "ES_JAVA_OPTS=-Xms512m -Xmx1024m" \
-v /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins \
-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data \
--restart=always \
-d elasticsearch:7.17.3
```

　　4、如果`/mydata`文件夹缺少权限，需要修改权限
```shell
chmod 777 /mydata
```

　　5、访问`localhost:9200`，返回记录了ES版本信息的JSON字符串

* ### 安装中文分词器

　　1、下载中文分词器IKAnalyzer，下载地址：<https://github.com/medcl/elasticsearch-analysis-ik/releases>

　　2、将分词器解压后的文件放入`/mydata/elasticsearch/plugins/ik`目录下

　　3、重启容器

* ### 安装Kibana

　　Kibana 是为 Elasticsearch设计的开源分析和可视化平台。

　　1、下载镜像

```shell
docker pull kibana:7.17.3
```

　　2、启动服务

```shell
--link elasticsearch:es \
-e "elasticsearch.hosts=http://es:9200" \
--restart=always \
-d kibana:7.17.3
```

　　3、访问`localhost:5601`

## 四、MongoDB

　　1、下载镜像

```shell
docker pull mongo:4
```

　　2、启动服务

```shell
docker run -p 27017:27017 --name mongo \
-v /mydata/mongo/db:/data/db \
--restart=always \
-d mongo:4
```

## 五、RabbitMQ

　　1、下载镜像

```shell
docker pull rabbitmq:3.9-management
```

　　2、启动服务

```shell
docker run -p 5672:5672 -p 15672:15672 --name rabbitmq \
-v /mydata/rabbitmq/data:/var/lib/rabbitmq \
--restart=always \
-d rabbitmq:3.9-management
```

　　3、访问`localhost:15672`，账号密码都是guest

## 六、Kafka

　　1、kafka需要zookeeper管理，所以需要下载两个镜像

```shell
docker pull wurstmeister/zookeeper
docker pull wurstmeister/kafka
```

　　2、启动zookeeper

```shell
docker run --name zookeeper \
-p 2181:2181 \
-v /etc/localtime:/etc/localtime \
-d wurstmeister/zookeeper
```

　　3、启动kafka

```shell
docker run --name kafka \
-p 9092:9092 \
-e KAFKA_BROKER_ID=0 \ #在kafka集群中，每个kafka都有一个BROKER_ID来区分自己
-e KAFKA_ZOOKEEPER_CONNECT=192.168.154.130:2181 \ #zookeeper服务地址
-e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://192.168.154.130:9092 \ #把kafka的地址端口注册给zookeeper
-e KAFKA_LISTENERS=PLAINTEXT://0.0.0.0:9092 \ #配置kafka的监听端口
-v /etc/localtime:/etc/localtime \ #容器时间同步虚拟机的时间
-d wurstmeister/kafka
```

　　4、进入kafka容器进行测试

```shell
docker exec -it kafka bash
```

　　创建topic：

```shell
cd /opt/kafka_2.13-2.8.1/bin
./kafka-topics.sh --create --zookeeper 192.168.154.130:2181 --replication-factor 1 --partitions 1 --topic mykafka
```

　　添加消息：

```shell
./kafka-console-producer.sh --broker-list 192.168.154.130:9092 --topic mykafka
```

　　消费消息：

```shell
./kafka-console-consumer.sh --bootstrap-server 192.168.154.130:9092 --topic mykafka --from-beginning
```

## 七、Oracle

　　1、下载镜像

```shell
docker pull registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g
```

　　2、运行容器

```shell
docker run --name oracle \
-p 1521:1521 \
-d registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g
```

　　3、进入容器

```shell
docker exec -it oracle bash
```

　　4、切换到root用户，密码是helowin

```shell
su root
```

　　5、编辑环境变量 `vi /home/oracle/.bashrc`，在文件最后加入以下命令

```shell
export ORACLE_HOME=/home/oracle/app/oracle/product/11.2.0/dbhome_2
export ORACLE_SID=helowin
export PATH=$ORACLE_HOME/bin:$PATH
```

　　保存退出，输入`source /home/oracle/.bashrc`使环境变量生效。

　　6、切换到oracle用户

```shell
su - oracle
```

　　7、进入Oracle命令行

```shell
sqlplus /nolog　　
```

　　8、使用sysdba用户登录

```shell
conn / as sysdba
```

　　9、使用navicat登录Oracle

<img src="/assets/img/linux/navicat连接oracle.png" alt="navicat连接oracle" style="zoom:67%;" />
