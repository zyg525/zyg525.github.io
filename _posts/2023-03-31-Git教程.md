---
title: Git教程
tags: Git 常用命令
---

## 一、创建版本库

　　创建版本库有2种方法：一是先创建本地版本库再和远程库关联，二是直接从远程库克隆。

* ### 创建本地版本库

　　1、在项目根目录下执行`init`命令，创建本地版本库

```shell
$ git init
```

　　2、将本地库和远程库关联

```shell
$ git remote add origin https://gitee.com/zyg525/springboot-test.git
```

　　3、查看远程库

```shell
$ git remote -v
```

　　4、删除远程库

```shell
$ git remote rm origin
```

* ### 从远程库克隆

```shell
$ git clone https://gitee.com/zyg525/springboot-test.git
```

## 二、修改文件

　　我们在工作区对文件进行修改，然后将修改后的文件添加到暂存区，最后将暂存区的文件提交到版本库。

* ### 工作区

　　工作区指的就是我们能看到的目录。与工作区相关的命令有：

　　1、比较文件内容

```shell
$ git diff readme.txt #查看工作区文件和暂存区中文件的区别
$ git diff HEAD -- readme.txt #查看工作区文件和版本库中最新版本的区别
```

　　2、将修改后的文件提交到暂存区

```shell
$ git add readme.txt
```

　　3、查看工作区和暂存区状态

```shell
$ git status
```

* ### 暂存区

　　与暂存区相关的命令有：

　　1、将暂存区的所有文件提交到版本库

```shell
$ git commit -m '第一次提交'
```

　　2、撤销修改，如果文件还未add到暂存区，那么撤销工作区的修改；如果文件已经add到暂存区，那么撤销暂存区的修改

```shell
$ git checkout -- readme.txt
```

* ### 版本库

　　与版本库相关的命令有：

　　1、查看提交日志

```shell
$ git log
$ git log --pretty=oneline #美化日志
```

　　2、将版本库回退至某个历史版本

```shell
$ git reset --hard HEAD^ #回退至上个版本
$ git reset --hard 3c6e #回退至某个commitId对应的版本
```

　　3、查询所有执行过的命令，可以用这个命令寻找消失的`commitId`

```shell
$ git reflog
```

## 三、分支管理

* ### 创建与合并分支

　　1、查看本地所有分支

```shell
$ git branch
```

　　2、以当前分支为基底，创建并切换到目标分支

```shell
$ git switch -c dev
```

　　3、切换分支

```shell
$ git switch master
```

　　4、合并目标分支到当前分支

```shell
$ git merge dev
```

　　默认使用`Fast forward`模式进行合并，这种模式下，删除分支后，会丢失分支信息，如果不想丢失分支信息，可以禁用该模式：

```shell
$ git merge --no-ff -m "merge with no-ff" dev
```

　　5、删除分支

```shell
$ git branch -d dev
$ git branch -D dev #强制删除未合并的分支
```

　　6、查看分支合并图谱

```shell
git log --graph --pretty=oneline --abbrev-commit
```

* ### 分支冲突

　　假设dev分支是以master分支为基底创建的新分支，在正常情况下，我们会修改dev分支，master分支保持不变，然后将dev分支合并到master分支，这时不会发生冲突，所谓的合并只不过是把master指针移到dev上。**但是如果master分支也被修改，此时dev分支的基底和master分支的最新版本不一致，就会发生冲突，此时需要找到冲突的内容进行修改，然后重新`add、commit`**。

* ### Bug分支

　　假如我们正在dev分支进行开发，工作区和暂存区都有修改的文件，如何在不commit这些文件的前提下，修改bug并commit到版本库呢？答案是使用`git stash`，这个命令可以暂时隐藏工作区和暂存区的文件。

```shell
$ git stash
```

　　当bug修改完成并commit之后，我们需要恢复工作区和暂存区的文件，首先查询stash：

```shell
$ git stash list
```

　　然后恢复stash：

```shell
$ git stash apply stash@{0}
```

## 四、远程协作

* ### 多人协作

　　1、查看所有远程分支列表

```shell
$ git branch -r
```

　　2、更新所有远程分支列表

```shell
$ git fetch origin
```

　　3、拉取远程分支，并合并到当前分支

```shell
$ git pull origin dev
$ git pull origin dev --allow-unrelated-histories #如果本地分支和远程分支没有关联，可以使用这个命令
```

　　**远程分支合并到本地分支的原理，和本地分支互相合并的原理一样，发生冲突原因就是本地分支基底发生变化，解决冲突的办法是手动修改冲突的内容。**

　　4、拉取远程分支到本地，但是不合并

```shell
$ git fetch origin dev #拉取远程dev分支到本地的origin/dev分支
```

　　在origin/dev分支的基础上创建新的分支newBranch：

```shell
$ git switch -c newBranch origin/dev
```

　　5、推送本地当前分支到远程分支，然后合并到远程分支

```shell
$ git push origin dev
```

　　**本地分支合并到远程分支的原理，和本地分支互相合并的原理一样，发生冲突原因就是远程分支基底发生变化，解决冲突的办法是重新pull远程最新分支，然后手动修改冲突内容，再重新push到远程分支。**

* ### 标签管理

　　1、为当前所在分支的最新提交创建标签

```shell
$ git tag v1.0
```

　　2、为某个commitId创建标签

```shell
$ git tag v1.1 0d52
$ git tag -a v1.1 -m "version 1.1 released" 0d52
```

　　3、查看所有标签

```shell
$ git tag
```

　　4、查看标签信息

```shell
$ git show v1.0
```

　　5、删除标签

```shell
$ git tag -d v1.0
```

　　6、推送本地标签到远程

```shell
$ git push origin v1.0
$ git push origin --tags #推送本地所有标签到远程
```

　　删除远程标签：

```shell
$ git push origin :refs/tags/v0.9
```

## 五、Git常用命令

![Git常用命令](/assets/img/linux/git-cheat-sheet.jpg)