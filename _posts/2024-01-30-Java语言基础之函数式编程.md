---
title: Java语言基础之函数式编程
categories: Java语言基础
tags: Java语言基础
layout: post
---



## Lambda表达式

　　Lambda表达式是JDK8的新特性。它允许将方法作为参数，传递给另一个方法。如果想把一个方法变成Lambda表达式，那么这个方法必须和函数式接口中的抽象方法的签名、返回值类型一样，函数式接口指的是只有一个抽象方法的接口。

　　Lambda表达式的写法：

```java
public static void main(String[] args) throws Exception {

    String[] array = new String[]{"a","c","d","z","f"};
    // 传统的匿名内部类写法
    Arrays.sort(array, new Comparator<String>() {
        @Override
        public int compare(String s1, String s2) {
            return s1.compareTo(s2);
        }
    });

    // Lambda表达式写法
    Arrays.sort(array, (s1, s2)->{
        return s1.compareTo(s2);
    });

    // Lambda表达式简化写法
    Arrays.sort(array, (s1, s2)->s1.compareTo(s2));
}
```

　　在上面的代码中，`Arrays.sort()`方法的签名是：

```java
public static <T> void sort(T[] a, Comparator<? super T> c) {...}
```

　　方法中第二个参数的类型是`Comparator`，它是一个函数式接口，它的抽象方法是：

```java
int compare(T o1, T o2);
```

　　该方法的特点是有两个相同类型的参数，返回一个int值，并且`Arrays.sort()`中第一个参数的元素类型是`String`，编译器会根据这些信息推断出Lambda表达式中的参数类型是`String`、返回值类型是`int`，所以在编写代码时可以省略这些信息。

## 方法引用

### 概述

　　Lambda表达式主要用于重写一个函数式接口中的抽象方法，然后将新方法作为参数使用，如果一个方法本来就存在，虽然也可以用Lambda表达式来将其作为参数使用，但还有更简单的写法，这就是方法引用。方法引用，顾名思义，就是一个方法的引用。

　　以上面的代码为例，还有更简单的写法：
```java
Arrays.sort(array, String::compareTo);
```

　　`String::compareTo`就是一个方法引用，它引用了`String`类中的`compareTo()`方法，这个方法的签名是：

```java
public int compareTo(String anotherString) {...}
```

　　该方法实际上有两个参数：`String this`和`String anotherString`，方法返回值是`int`类型，因此符合`Comparator`接口中的抽象方法的签名，所以可以用方法引用代替Lambda表达式。

### 方法引用分类

　　方法引用可以分为：**静态方法引用、普通实例方法引用、特殊实例方法引用、构造方法引用**。

```java
static int m1(String s1, String s2) {
    return s1.compareTo(s2);
}

int m2(String s1, String s2) {
    return s1.compareTo(s2);
}
public static void main(String[] args) throws Exception {

    String[] array = new String[]{"a","c","d","z","f"};
    // 静态方法引用
    Arrays.sort(array, Test::m1);
    // 普通实例方法引用
    Arrays.sort(array, new Test()::m2);

}
```

　　这里的特殊实例方法指的是概述中介绍的那种方法，即需要加上隐含的this参数后方法签名才能一致，这种实例方法的引用方式是`类名::方法名`。除此之外的实例方法都是普通实例方法，它们的引用方式是`实例::方法名`。

　　构造方法的引用方式是`构造方法名::new`。